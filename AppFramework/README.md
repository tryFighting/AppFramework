#  iOS的离屏渲染
概述：OpenGL ES是一套多功能开放标准的用于嵌入系统的C-based的图形库，用于2D和3D数据结构的可视化
OpenGL被设计用来转换一组图形调用功能到底层图形硬件GPU，由GPU执行图形命令，用来实现复杂的图形操作和运算，从而能够高性能，高帧率利用GPU提供的2D和3D绘制能力 GPU屏幕渲染方式中有一种方式为离屏渲染，处理不好离屏渲染往往会对APP的性能产生较大的影响

GPU离屏渲染有两种方式 On-Screen Rendering(当前屏幕渲染)指的是GPU的渲染操作是在当前用于显示的屏幕缓冲区进行
Off-Screen Rendering（离屏渲染）指的是在GPU在当前屏幕缓冲区以外开辟一个缓冲区进行渲染操作。
当前屏幕渲染不需要额外创建新的缓存，也不需要开启新的上下文，相对于离屏渲染性能更好。但是受当前屏幕渲染的局部限制因素（只有自身上下文，屏幕缓存有限等），有限情况是当前屏幕渲染解决不了的，就要使用到离屏渲染。

离屏渲染的代价是很高的：
1.创建新缓冲区
2.上下文切换：离屏渲染需要多次切换上下文环境：先从当前屏幕切换到离屏，等到离屏渲染结束以后，将离屏缓冲区的渲染结果显示到屏幕上有需要将上下文环境从离屏切换到当前屏幕
如果我们重写了drawRect方法，并且使用任何Core Graphics的技术进行了绘制操作，就涉及到离屏渲染
由于垂直同步的机制，如果在一个水平同步信号时间内，CPU或GPU没有完成内容提交，则那一帧就会被丢弃，等到下一次机会再显示，而这显示屏会保留之前的内容不变。这就是界面卡顿的原因

离屏渲染机制原因：有些效果被认为不能直接呈现于屏幕，而需要在别的地方做额外的处理预合成,图层属性的混合体没有预合成之前不能直接在屏幕中绘制，所以就需要屏幕外渲染，意味着图层必须在被显示之前在一个屏幕外上下文中被渲染(不论CPU和GPU)

离屏渲染出现的操作：
1.为图层设置遮罩
2.将图层的layer.masksToBounds/view.clipsToBounds属性设置为True
3.将图层layer.allowsGroupOpacity属性设置为YES和layer.opacity小于1.0
4.具有layer.cornerRadius,layer.edgeAntialiasingMask的图层
5.文本（任何种类，包括UILabel,CATextLayer,Core Text）
6.使用CGContext在drawRect方法中绘制大部分情况下回导致离屏渲染，甚至仅仅是一个空的实现

优化方案：
1.使用贝塞尔曲线UIBezierPath和Core Graphics框架画出一个圆角
2.使用CAShapeLayer和UIBezierPath设置圆角

